# DevoLight 智能体整合架构

## 核心架构模式

### 1. 多Agent协作系统
```
用户输入 → 意图识别 → Agent路由 → 并行/串行处理 → 结果整合 → 统一输出
```

### 2. 三种交互模式

#### 模式A：单Agent模式
```
用户 → 指定角色 → 单个Agent → 直接回应
```
**适用场景**：用户明确知道想要什么类型的帮助

#### 模式B：顺序协作模式  
```
用户输入 → 安提阿老师 → 路加笔者 → 马大姊妹 → 巴拿巴友伴 → 综合输出
```
**适用场景**：深度灵修学习，完整的经文研究体验

#### 模式C：智能协作模式
```
用户输入 → AI路由器 → 选择最适合的1-3个Agent → 协作处理 → 整合回应
```
**适用场景**：日常使用，系统自动判断最佳响应方式

## 技术实现方案

### 1. 前端架构（Web/移动端）
```
┌─────────────────────────────────────┐
│            用户界面层                │
├─────────────────────────────────────┤
│  ┌─────────┐ ┌─────────┐ ┌─────────┐ │
│  │聊天界面 │ │模式选择│ │历史记录│ │
│  └─────────┘ └─────────┘ └─────────┘ │
├─────────────────────────────────────┤
│            状态管理层                │
├─────────────────────────────────────┤
│            API 通信层               │
└─────────────────────────────────────┘
```

### 2. 后端架构
```
┌─────────────────────────────────────┐
│         API Gateway                 │
├─────────────────────────────────────┤
│  ┌─────────┐ ┌─────────┐ ┌─────────┐ │
│  │用户管理│ │会话管理│ │内容管理│ │
│  └─────────┘ └─────────┘ └─────────┘ │
├─────────────────────────────────────┤
│         Agent 协调器                │
├─────────────────────────────────────┤
│ ┌─────┐ ┌─────┐ ┌─────┐ ┌─────────┐ │
│ │安提阿│ │路加 │ │马大 │ │巴拿巴  │ │
│ │老师 │ │笔者 │ │姊妹 │ │友伴    │ │
│ └─────┘ └─────┘ └─────┘ └─────────┘ │
├─────────────────────────────────────┤
│         数据存储层                  │
│  ┌─────────┐ ┌─────────┐ ┌─────────┐ │
│  │圣经数据│ │用户数据│ │对话历史│ │
│  └─────────┘ └─────────┘ └─────────┘ │
└─────────────────────────────────────┘
```

## 数据流设计

### 输入数据结构
```json
{
  "input": {
    "scripture": "约3:16",
    "text": "神爱世人...(可选)",
    "user_query": "请解释这段经文",
    "mode": "intelligent|single|sequential",
    "selected_agents": ["antioch", "luke"],
    "user_profile": {
      "age_group": "30岁",
      "profession": "程序员", 
      "spiritual_state": "压力大",
      "concerns": ["工作焦虑"]
    },
    "session_id": "uuid",
    "context": "对话历史"
  }
}
```

### 输出数据结构
```json
{
  "output": {
    "session_id": "uuid",
    "responses": [
      {
        "agent": "antioch_teacher",
        "role_name": "安提阿老师", 
        "content": "🕊️ 安提阿老师的解经分享...",
        "references": ["罗5:8", "弗2:8-9"],
        "confidence": 0.95
      }
    ],
    "summary": "核心要点总结",
    "follow_up_suggestions": ["继续学习相关经文"],
    "timestamp": "2024-01-01T10:00:00Z"
  }
}
```

## 实现技术栈建议

### 前端选项
1. **Web应用**: React/Vue + TypeScript
2. **移动端**: React Native / Flutter  
3. **桌面端**: Electron

### 后端选项
1. **Node.js**: Express + TypeScript
2. **Python**: FastAPI + SQLAlchemy
3. **Go**: Gin + GORM

### 数据库
1. **主数据库**: PostgreSQL (用户数据、对话历史)
2. **圣经数据**: SQLite (离线访问)
3. **缓存**: Redis (会话状态)

### AI集成方案
1. **Claude API**: 通过Anthropic API调用不同角色
2. **本地部署**: 使用开源模型 + fine-tuning
3. **混合方案**: 核心功能用Claude，辅助功能用本地模型

## 开发路线图

### Phase 1: MVP (4-6周)
- [ ] 基础聊天界面
- [ ] 单Agent模式实现
- [ ] 圣经文本数据集成
- [ ] 用户会话管理

### Phase 2: 增强功能 (6-8周)  
- [ ] 智能路由系统
- [ ] 用户画像系统
- [ ] 多Agent协作
- [ ] 历史记录功能

### Phase 3: 完整产品 (8-12周)
- [ ] 移动端应用
- [ ] 离线功能
- [ ] 个性化推荐
- [ ] 社区功能

## 即刻可开始的原型

让我们先创建一个简单的Web原型来验证概念？